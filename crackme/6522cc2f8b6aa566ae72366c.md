# 6522cc2f8b6aa566ae72366c
* pass : `&#x46;&#x52;&#x45;&#x45;&#x4d;&#x41;&#x53;&#x4f;&#x4e;&#x52;&#x59;`

## Video
[![video](https://img.youtube.com/vi/k9nHvJ5AZ7g/hqdefault.jpg)](https://youtu.be/k9nHvJ5AZ7g)

**What makes it a special** :
* obfuscation which create exception when decompiling methods.
* debugger detection.
* order of the line of codes is obfuscated using loops and switch with a "next line" paramters equal to arithmetic operations.

## Walkthrough

When we open the binary with dnSpy, you will see that classes names has been obfuscated but also that exception with decompiler prevents us from seeing anything interesting.

|`An exception occurred when decompiling this method (06000004)`|
|:-:|
|![image](https://github.com/Cyril-Meyer/RCE/assets/69190238/bde09320-3941-4989-a624-c11b7dd66e50)|

Before trying anything complicated, we can try to debug the process using the dnSpy integrated debugger.
The process crash due to a `Environment.FailFast(null);` call.

|`System.ExecutionEngineException`|
|:-:|
|![image](https://github.com/Cyril-Meyer/RCE/assets/69190238/53b46fa3-e45e-4079-b881-f606f6337837)|

If we look more in details into the class, we can understand that this call is triggered because of the `internal static bool Detected()` method, which probably detect the debugging.
We will analysis this more in details in the `Detected()` section.
For now, lets focus on the **key**.

Even if the process crash, dnSpy allow us to analysis it.
So, now we can view the code withtout the previous decompiling exception.

There is 4 renamed by obfuscation :
* `private static void <ECPpdSdBteSsGbtNLqLwpCofjRjOYDjWZgsvJrPfhjyCwJdkTszHJPMboKfmIoDQVVtAIYeuAFpfeMIzOZVGeBmjurhYlDwSGIGAqDCUofgdAGWBcGxJsXLuJkfrRfi>()`
* `private void <MLAckGFFeaxppyOZZwLCQvaoLqSxAaTGvWqQcunLanJrFZJHTxMVPozrLlqTNifdgQTsiYXEjaCDLIJLHlEcoXRgwZeQetXShGkPgqyUAhMOMWFcCEmCEdPiZMVjTgAPcKvfxUErMJCglcuAtcozhvneQcPuupatHXMcAAEIZVPVAJXW>()`
* `private void <svPRSbIHwrovekWxIiznpraTxGzlFsDheTcZzjBFpfGiljDPZsmsjJGauWtlBwbeOgqliXYzGTYkLRHocKmnfkXumb>(object sender, EventArgs e)`
* `public static void <swbMlBElspAKrtSZRQOZGTwGAYmVrgmAMcNspMjsXIhoelaOtgyNmalyZvlmpITmdZXpGzJfGvcXLiBpYyBlIyoMRosUAXdoOVlfnLiTwtgQYnNRTWoQhIEELkxrhPEJsNiQXwbmqHOosxODBBaEImhgrGtcnQMHPxxkeWTwUbAzUplnwUPGOZagGczqdZYzVgzVaEyFHEKHLImbugGtbfSPwrEcxCtVcbDNQqnSvkYkptuYPxVWsFxPoJyJZvhflPEKezleTOXRhIAdWGnaGwCxDOzgS>()`

Looking at the code and specialy the called method, we can "rename" them in our mind by what they do.
As we already work on a crackme from the same author ([64fb27f4d931496abf909849](64fb27f4d931496abf909849.md)) we can imagine that the architeture  is similar.
* `private static void Main()`
* `private void InitializeComponent()`
* `private void checkButton_Click(object sender, EventArgs e)`
* `public static void crashIfDetection()`


#### `Detected()`

